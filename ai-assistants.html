<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistants - Virtual OPEX - Sodexo</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <link rel="stylesheet" href="assets/vendors/iconly/bold.css">
    <link rel="stylesheet" href="assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="assets/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="assets/css/app.css">
    <link rel="shortcut icon" href="assets/images/favicon.svg" type="image/x-icon">
    
    <style>
        /* Estilos adicionales para mejorar la interfaz de IA */
        .assistant-item {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .assistant-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .assistant-item.active {
            border-color: #435ebe !important;
            background-color: rgba(67, 94, 190, 0.05);
        }
        
        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
        }
        
        .ai-message .message-bubble {
            background-color: #f0f5ff;
            border-bottom-left-radius: 4px;
        }
        
        .user-message .message-bubble {
            background-color: #435ebe;
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .chat-container {
            scroll-behavior: smooth;
        }
        
        .typing-indicator {
            display: none;
            padding: 10px 16px;
        }
        
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #bbb;
            border-radius: 50%;
            display: inline-block;
            margin: 0 1px;
            animation: typing 1.5s infinite ease-in-out;
        }
        
        .typing-indicator span:nth-child(1) {
            animation-delay: 0s;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .quick-action-btn {
            transition: all 0.2s ease;
        }
        
        .quick-action-btn:hover {
            transform: scale(1.05);
        }
        
        .conversation-item {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .conversation-item:hover {
            background-color: #f8f9fa;
        }
        
        .assistant-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ai-avatar {
            background-color: #e9ecef;
        }
        
        .user-avatar {
            background-color: #dee2e6;
        }
        
        .capability-item, .recommendation-item {
            transition: transform 0.2s ease;
        }
        
        .capability-item:hover, .recommendation-item:hover {
            transform: translateX(5px);
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .insight-alert {
            border-left: 4px solid #17a2b8;
        }
        
        .performance-chart {
            height: 200px;
            background: linear-gradient(180deg, rgba(67, 94, 190, 0.1) 0%, rgba(255,255,255,0) 100%);
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 30px;
            background-color: #435ebe;
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
        }
        
        .chart-label {
            position: absolute;
            bottom: -25px;
            text-align: center;
            width: 30px;
            font-size: 0.75rem;
        }
    </style>
</head>

<body>
    <div id="app">
        <div id="sidebar" class="active">
            <!-- Sidebar content remains the same as in the original -->
            <div class="sidebar-wrapper active">
                <div class="sidebar-header">
                    <div class="d-flex justify-content-between">
                        <div class="logo">
                            <a href="index.html"><img src="assets/images/logo/logo.png" alt="Sodexo Logo" srcset=""></a>
                        </div>
                        <div class="toggler">
                            <a href="#" class="sidebar-hide d-xl-none d-block"><i class="bi bi-x bi-middle"></i></a>
                        </div>
                    </div>
                </div>
                <div class="sidebar-menu">
                    <ul class="menu">
                        <li class="sidebar-title">Virtual OPEX</li>

                        <li class="sidebar-item ">
                            <a href="dasboard.html" class='sidebar-link'>
                                <i class="bi bi-grid-fill"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>

                        <li class="sidebar-item  has-sub">
                            <a href="#" class='sidebar-link'>
                                <i class="bi bi-graph-up"></i>
                                <span>Commercial <br> Excellence</span>
                            </a>
                            <ul class="submenu ">
                                <li class="submenu-item ">
                                    <a href="commercial-bid-analysis.html">Bid Analysis</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="contract-risk.html">Contract Risk Screening</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="pricing-optimization.html">Pricing Optimization</a>
                                </li>
                            </ul>
                        </li>

                        <li class="sidebar-item  has-sub">
                            <a href="#" class='sidebar-link'>
                                <i class="bi bi-building"></i>
                                <span>Site <br> Mobilization</span>
                            </a>
                            <ul class="submenu ">
                                <li class="submenu-item ">
                                    <a href="mobilization-dashboard.html">Mobilization Dashboard</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="checklist-management.html">Checklist Management</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="progress-tracking.html">Progress Tracking</a>
                                </li>
                            </ul>
                        </li>

                        <li class="sidebar-item  has-sub">
                            <a href="#" class='sidebar-link'>
                                <i class="bi bi-gear-fill"></i>
                                <span>Operational <br> Excellence</span>
                            </a>
                            <ul class="submenu ">
                                <li class="submenu-item ">
                                    <a href="performance-monitoring.html">Performance Monitoring</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="account-recovery.html">Account Recovery</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="kpi-analytics.html">KPI Analytics</a>
                                </li>
                            </ul>
                        </li>

                        <li class="sidebar-title">Tools & Analytics</li>

                        <li class="sidebar-item  has-sub">
                            <a href="#" class='sidebar-link'>
                                <i class="bi bi-bar-chart-fill"></i>
                                <span>Reports</span>
                            </a>
                            <ul class="submenu ">
                                <li class="submenu-item ">
                                    <a href="financial-performance.html">Financial Performance</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="operational-metrics.html">Operational Metrics</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="client-retention.html">Client Retention</a>
                                </li>
                            </ul>
                        </li>

                        <li class="sidebar-item active ">
                            <a href="ai-assistants.html" class='sidebar-link'>
                                <i class="bi bi-robot"></i>
                                <span>AI Assistants</span>
                            </a>
                        </li>

                        <li class="sidebar-item  has-sub">
                            <a href="#" class='sidebar-link'>
                                <i class="bi bi-sliders"></i>
                                <span>Settings</span>
                            </a>
                            <ul class="submenu ">
                                <li class="submenu-item ">
                                    <a href="user-management.html">User Management</a>
                                </li>
                                <li class="submenu-item ">
                                    <a href="system-configuration.html">System Configuration</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <button class="sidebar-toggler btn x"><i data-feather="x"></i></button>
            </div>
        </div>
        <div id="main">
            <header class="mb-3">
                <a href="#" class="burger-btn d-block d-xl-none">
                    <i class="bi bi-justify fs-3"></i>
                </a>
            </header>

            <div class="page-heading">
                <div class="row">
                    <div class="col-8">
                        <h3>AI Assistants</h3>
                        <p class="text-subtitle text-muted">Interactive AI-powered assistants for operational excellence</p>
                    </div>
                    <div class="col-4 text-end">
                        <button class="btn btn-primary" id="newChatBtn">
                            <i class="bi bi-plus-circle"></i> New Chat
                        </button>
                    </div>
                </div>
            </div>

            <div class="page-content">
                <section class="row">
                    <!-- AI Assistant Selection -->
                    <div class="col-12 col-lg-4">
                        <!-- Available Assistants -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Available AI Assistants</h4>
                            </div>
                            <div class="card-body">
                                <div class="assistants-list">
                                    <div class="assistant-item active p-3 border rounded mb-3" data-assistant="bid-analysis">
                                        <div class="d-flex align-items-center">
                                            <div class="assistant-avatar me-3 ai-avatar">
                                                <i class="bi bi-graph-up text-primary fs-4"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-1">Bid Analysis Assistant</h6>
                                                <p class="text-muted mb-0 small">Analyzes contract bids and identifies risks</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="assistant-item p-3 border rounded mb-3" data-assistant="mobilization">
                                        <div class="d-flex align-items-center">
                                            <div class="assistant-avatar me-3 ai-avatar">
                                                <i class="bi bi-building text-success fs-4"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-1">Mobilization Coach</h6>
                                                <p class="text-muted mb-0 small">Guides site mobilization and checklist management</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="assistant-item p-3 border rounded mb-3" data-assistant="performance">
                                        <div class="d-flex align-items-center">
                                            <div class="assistant-avatar me-3 ai-avatar">
                                                <i class="bi bi-gear text-warning fs-4"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-1">Performance Advisor</h6>
                                                <p class="text-muted mb-0 small">Monitors site performance and suggests improvements</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="assistant-item p-3 border rounded" data-assistant="financial">
                                        <div class="d-flex align-items-center">
                                            <div class="assistant-avatar me-3 ai-avatar">
                                                <i class="bi bi-currency-dollar text-info fs-4"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-1">Financial Analyst</h6>
                                                <p class="text-muted mb-0 small">Provides financial insights and margin optimization</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Quick Actions</h4>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-outline-primary w-100 mb-2 quick-action-btn" data-action="analyze-contract">
                                    <i class="bi bi-file-earmark-text"></i> Analyze Contract
                                </button>
                                <button class="btn btn-outline-success w-100 mb-2 quick-action-btn" data-action="performance-review">
                                    <i class="bi bi-graph-up"></i> Performance Review
                                </button>
                                <button class="btn btn-outline-warning w-100 mb-2 quick-action-btn" data-action="margin-simulation">
                                    <i class="bi bi-calculator"></i> Margin Simulation
                                </button>
                                <button class="btn btn-outline-info w-100 quick-action-btn" data-action="get-recommendations">
                                    <i class="bi bi-lightbulb"></i> Get Recommendations
                                </button>
                            </div>
                        </div>

                        <!-- Assistant Capabilities -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Assistant Capabilities</h4>
                            </div>
                            <div class="card-body">
                                <div class="capabilities-list">
                                    <div class="capability-item d-flex align-items-center mb-2">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>Real-time risk analysis</span>
                                    </div>
                                    <div class="capability-item d-flex align-items-center mb-2">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>Predictive insights</span>
                                    </div>
                                    <div class="capability-item d-flex align-items-center mb-2">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>Data-driven recommendations</span>
                                    </div>
                                    <div class="capability-item d-flex align-items-center mb-2">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>Historical pattern recognition</span>
                                    </div>
                                    <div class="capability-item d-flex align-items-center">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>Automated reporting</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Interface -->
                    <div class="col-12 col-lg-8">
                        <div class="card">
                            <div class="card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h4 class="mb-0" id="assistantName">Bid Analysis Assistant</h4>
                                        <small class="text-muted" id="assistantStatus">Online - Ready to help</small>
                                    </div>
                                    <div class="assistant-status">
                                        <span class="badge bg-success" id="statusBadge">
                                            <i class="bi bi-circle-fill me-1"></i>
                                            Active
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <!-- Chat Messages -->
                                <div class="chat-container" id="chatContainer" style="height: 500px; overflow-y: auto; padding: 20px;">
                                    <!-- Welcome Message -->
                                    <div class="chat-message ai-message mb-4">
                                        <div class="message-avatar ai-avatar">
                                            <i class="bi bi-robot text-primary"></i>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <p class="mb-2">Hello! I'm your Bid Analysis Assistant. I can help you:</p>
                                                <ul class="mb-2">
                                                    <li>Analyze contract bids for risks</li>
                                                    <li>Compare pricing with historical data</li>
                                                    <li>Identify margin optimization opportunities</li>
                                                    <li>Generate risk assessment reports</li>
                                                </ul>
                                                <p class="mb-0">What would you like me to analyze today?</p>
                                            </div>
                                            <small class="text-muted">Just now</small>
                                        </div>
                                    </div>

                                    <!-- User Message -->
                                    <div class="chat-message user-message mb-4">
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <p class="mb-0">Can you analyze the new healthcare campus RFP? The proposed margin is 14.2% and contract value is $8.5M for 3 years.</p>
                                            </div>
                                            <small class="text-muted">Just now</small>
                                        </div>
                                        <div class="message-avatar user-avatar">
                                            <i class="bi bi-person-circle text-secondary"></i>
                                        </div>
                                    </div>

                                    <!-- AI Response -->
                                    <div class="chat-message ai-message mb-4">
                                        <div class="message-avatar ai-avatar">
                                            <i class="bi bi-robot text-primary"></i>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <div class="alert alert-warning mb-3">
                                                    <i class="bi bi-exclamation-triangle"></i>
                                                    <strong>Risk Detected:</strong> Labor assumptions 15% below historical benchmarks for similar healthcare contracts.
                                                </div>
                                                
                                                <h6>Analysis Summary:</h6>
                                                <div class="row mb-3">
                                                    <div class="col-6">
                                                        <strong>Contract Value:</strong> $8.5M<br>
                                                        <strong>Proposed Margin:</strong> 14.2%<br>
                                                        <strong>Risk Score:</strong> <span class="badge bg-warning">65/100</span>
                                                    </div>
                                                    <div class="col-6">
                                                        <strong>Historical Average:</strong> 18.3%<br>
                                                        <strong>Market Benchmark:</strong> 16.7%<br>
                                                        <strong>Margin Gap:</strong> -4.1%
                                                    </div>
                                                </div>

                                                <h6>Recommendations:</h6>
                                                <div class="recommendation-item mb-2">
                                                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                    Adjust labor model - increase FTE count by 2.5
                                                </div>
                                                <div class="recommendation-item mb-2">
                                                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                    Consider tiered pricing for specialized services
                                                </div>
                                                <div class="recommendation-item">
                                                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                    Add inflation adjustment clause for years 2-3
                                                </div>

                                                <div class="mt-3 p-3 bg-light rounded">
                                                    <small><strong>Expected Impact:</strong> Implementing these changes could improve margin to 17.8% and reduce risk score to 25/100.</small>
                                                </div>
                                            </div>
                                            <small class="text-muted">Just now</small>
                                        </div>
                                    </div>

                                    <!-- User Follow-up -->
                                    <div class="chat-message user-message mb-4">
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <p class="mb-0">What's the historical performance of similar healthcare contracts in the Midwest region?</p>
                                            </div>
                                            <small class="text-muted">Just now</small>
                                        </div>
                                        <div class="message-avatar user-avatar">
                                            <i class="bi bi-person-circle text-secondary"></i>
                                        </div>
                                    </div>

                                    <!-- AI Response with Data -->
                                    <div class="chat-message ai-message">
                                        <div class="message-avatar ai-avatar">
                                            <i class="bi bi-robot text-primary"></i>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <h6>Midwest Healthcare Contracts Analysis</h6>
                                                <div class="performance-data mb-3">
                                                    <div class="row text-center">
                                                        <div class="col-4">
                                                            <div class="metric-value text-success">18.7%</div>
                                                            <small class="text-muted">Avg. Margin</small>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="metric-value text-warning">92%</div>
                                                            <small class="text-muted">Retention Rate</small>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="metric-value text-info">2.4%</div>
                                                            <small class="text-muted">Food Waste</small>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Performance Chart -->
                                                <div class="performance-chart mb-3 p-3">
                                                    <div class="chart-bar" style="left: 10%; height: 70%;"></div>
                                                    <div class="chart-label" style="left: 10%;">Labor</div>
                                                    
                                                    <div class="chart-bar" style="left: 30%; height: 45%;"></div>
                                                    <div class="chart-label" style="left: 30%;">Food</div>
                                                    
                                                    <div class="chart-bar" style="left: 50%; height: 60%;"></div>
                                                    <div class="chart-label" style="left: 50%;">Ops</div>
                                                    
                                                    <div class="chart-bar" style="left: 70%; height: 85%;"></div>
                                                    <div class="chart-label" style="left: 70%;">Admin</div>
                                                    
                                                    <div class="chart-bar" style="left: 90%; height: 40%;"></div>
                                                    <div class="chart-label" style="left: 90%;">Other</div>
                                                </div>

                                                <div class="comparison-table">
                                                    <table class="table table-sm">
                                                        <thead>
                                                            <tr>
                                                                <th>Metric</th>
                                                                <th>Your Bid</th>
                                                                <th>Region Avg.</th>
                                                                <th>Gap</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Labor Cost %</td>
                                                                <td>45.2%</td>
                                                                <td>41.8%</td>
                                                                <td class="text-danger">+3.4%</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Food Cost %</td>
                                                                <td>28.7%</td>
                                                                <td>29.1%</td>
                                                                <td class="text-success">-0.4%</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Service Time</td>
                                                                <td>3.2 min</td>
                                                                <td>2.8 min</td>
                                                                <td class="text-danger">+0.4 min</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <div class="insight-alert mt-3 p-3 bg-info text-white rounded">
                                                    <i class="bi bi-lightbulb"></i>
                                                    <strong>Insight:</strong> Your proposed labor cost is 3.4% above regional average. Optimizing staffing could close the margin gap significantly.
                                                </div>
                                            </div>
                                            <small class="text-muted">Just now</small>
                                        </div>
                                    </div>
                                    
                                    <!-- Typing Indicator -->
                                    <div class="chat-message ai-message typing-indicator" id="typingIndicator">
                                        <div class="message-avatar ai-avatar">
                                            <i class="bi bi-robot text-primary"></i>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Chat Input -->
                                <div class="chat-input border-top p-3">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Type your message..." id="messageInput">
                                        <button class="btn btn-primary" type="button" id="sendMessageBtn">
                                            <i class="bi bi-send"></i>
                                        </button>
                                    </div>
                                    <div class="quick-actions mt-2">
                                        <button class="btn btn-sm btn-outline-secondary me-1 chat-quick-action" data-action="analyze-bid">
                                            <i class="bi bi-graph-up"></i> Analyze Bid
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary me-1 chat-quick-action" data-action="margin-sim">
                                            <i class="bi bi-calculator"></i> Margin Sim
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary chat-quick-action" data-action="generate-report">
                                            <i class="bi bi-file-text"></i> Generate Report
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Conversation History -->
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h4 class="mb-0">Recent Conversations</h4>
                                <button class="btn btn-sm btn-outline-secondary" id="clearHistoryBtn">
                                    <i class="bi bi-trash"></i> Clear
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="conversation-list">
                                    <div class="conversation-item d-flex justify-content-between align-items-center p-3 border rounded mb-2">
                                        <div>
                                            <h6 class="mb-1">Healthcare RFP Analysis</h6>
                                            <p class="text-muted mb-0 small">Last message: 5 minutes ago</p>
                                        </div>
                                        <span class="badge bg-primary">Active</span>
                                    </div>
                                    <div class="conversation-item d-flex justify-content-between align-items-center p-3 border rounded mb-2">
                                        <div>
                                            <h6 class="mb-1">University Contract Review</h6>
                                            <p class="text-muted mb-0 small">Last message: 2 hours ago</p>
                                        </div>
                                        <span class="badge bg-secondary">Closed</span>
                                    </div>
                                    <div class="conversation-item d-flex justify-content-between align-items-center p-3 border rounded">
                                        <div>
                                            <h6 class="mb-1">Corporate Campus Pricing</h6>
                                            <p class="text-muted mb-0 small">Last message: 1 day ago</p>
                                        </div>
                                        <span class="badge bg-secondary">Closed</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <footer>
                <div class="footer clearfix mb-0 text-muted">
                    <div class="float-start">
                        <p>2025 &copy; Virtual OPEX - Sodexo</p>
                    </div>
                    <div class="float-end">
                        <p>Powered by <span class="text-danger"><i class="bi bi-heart"></i></span> <a
                                href="http://thirdwishfs.com" target="_blank">Thirdwish Food Services</a></p>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Enhanced chat functionality
        document.addEventListener('DOMContentLoaded', function() {
            const messageInput = document.getElementById('messageInput');
            const sendMessageBtn = document.getElementById('sendMessageBtn');
            const chatContainer = document.getElementById('chatContainer');
            const newChatBtn = document.getElementById('newChatBtn');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const typingIndicator = document.getElementById('typingIndicator');
            const assistantName = document.getElementById('assistantName');
            const assistantStatus = document.getElementById('assistantStatus');
            const statusBadge = document.getElementById('statusBadge');
            
            let currentAssistant = 'bid-analysis';
            let conversationHistory = [];

            // Assistant data
            const assistants = {
                'bid-analysis': {
                    name: 'Bid Analysis Assistant',
                    description: 'Analyzes contract bids and identifies risks',
                    welcomeMessage: "Hello! I'm your Bid Analysis Assistant. I can help you analyze contract bids for risks, compare pricing with historical data, identify margin optimization opportunities, and generate risk assessment reports. What would you like me to analyze today?",
                    color: 'primary'
                },
                'mobilization': {
                    name: 'Mobilization Coach',
                    description: 'Guides site mobilization and checklist management',
                    welcomeMessage: "Hello! I'm your Mobilization Coach. I can help you with site mobilization planning, checklist management, progress tracking, and resource allocation. How can I assist with your mobilization project today?",
                    color: 'success'
                },
                'performance': {
                    name: 'Performance Advisor',
                    description: 'Monitors site performance and suggests improvements',
                    welcomeMessage: "Hello! I'm your Performance Advisor. I can help you monitor site performance metrics, identify improvement opportunities, analyze KPI trends, and provide data-driven recommendations. What performance aspect would you like to discuss?",
                    color: 'warning'
                },
                'financial': {
                    name: 'Financial Analyst',
                    description: 'Provides financial insights and margin optimization',
                    welcomeMessage: "Hello! I'm your Financial Analyst. I can help you with financial performance analysis, margin optimization, cost control strategies, and profitability insights. What financial aspect would you like to explore?",
                    color: 'info'
                }
            };

            // Send message function
            function sendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    // Add user message
                    addMessage(message, 'user');
                    
                    // Save to conversation history
                    conversationHistory.push({
                        type: 'user',
                        content: message,
                        timestamp: new Date()
                    });
                    
                    // Clear input
                    messageInput.value = '';
                    
                    // Show typing indicator
                    showTypingIndicator();
                    
                    // Simulate AI response after delay
                    setTimeout(() => {
                        hideTypingIndicator();
                        const aiResponse = generateAIResponse(message, currentAssistant);
                        addMessage(aiResponse, 'ai');
                        
                        // Save AI response to conversation history
                        conversationHistory.push({
                            type: 'ai',
                            content: aiResponse,
                            timestamp: new Date()
                        });
                    }, 1500 + Math.random() * 2000); // Random delay between 1.5-3.5 seconds
                }
            }

            // Add message to chat
            function addMessage(content, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${sender}-message mb-4`;
                
                const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                if (sender === 'user') {
                    messageDiv.innerHTML = `
                        <div class="message-content">
                            <div class="message-bubble">
                                <p class="mb-0">${content}</p>
                            </div>
                            <small class="text-muted">${timestamp}</small>
                        </div>
                        <div class="message-avatar user-avatar">
                            <i class="bi bi-person-circle text-secondary"></i>
                        </div>
                    `;
                } else {
                    messageDiv.innerHTML = `
                        <div class="message-avatar ai-avatar">
                            <i class="bi bi-robot text-${assistants[currentAssistant].color}"></i>
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <p class="mb-0">${content}</p>
                            </div>
                            <small class="text-muted">${timestamp}</small>
                        </div>
                    `;
                }
                
                // Remove typing indicator if present
                if (typingIndicator.style.display !== 'none') {
                    typingIndicator.style.display = 'none';
                }
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Show typing indicator
            function showTypingIndicator() {
                typingIndicator.style.display = 'flex';
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Hide typing indicator
            function hideTypingIndicator() {
                typingIndicator.style.display = 'none';
            }

            // Generate AI response based on user message and assistant type
            function generateAIResponse(userMessage, assistantType) {
                const responses = {
                    'bid-analysis': [
                        "I've analyzed your bid and identified several key risk factors. The labor cost assumptions appear to be 12% below industry benchmarks for similar contracts.",
                        "Based on historical data for contracts of this size and sector, I'm seeing a potential margin gap of 3.2%. Let me provide a detailed breakdown.",
                        "Your pricing strategy looks competitive, but I've identified some areas where operational efficiencies could improve profitability by 2-4%.",
                        "I've compared your bid against 27 similar contracts in our database. The risk score is moderate, but there are optimization opportunities."
                    ],
                    'mobilization': [
                        "Based on your mobilization timeline, I recommend prioritizing the kitchen equipment installation phase to avoid delays in other areas.",
                        "I've reviewed your checklist and identified 3 critical path items that need immediate attention to stay on schedule.",
                        "The resource allocation plan looks good, but I suggest increasing staffing during the first two weeks to handle unexpected issues.",
                        "Based on similar mobilizations, I estimate a 92% probability of completing on time if you follow the recommended adjustments."
                    ],
                    'performance': [
                        "I've analyzed the performance metrics and identified a 15% improvement opportunity in labor efficiency during peak hours.",
                        "The customer satisfaction scores are strong, but there's a correlation between service speed and repeat business we should address.",
                        "Compared to similar sites, your food cost percentage is 2.3% above benchmark. Let me suggest some optimization strategies.",
                        "The KPI trends show consistent improvement in safety metrics, but there's an opportunity in waste reduction."
                    ],
                    'financial': [
                        "The financial projections look solid, but I've identified a potential 4.7% improvement in gross margin through supply chain optimization.",
                        "Based on the cost structure analysis, there's an opportunity to reduce overhead by 2.1% without impacting service quality.",
                        "I've compared your financial performance against industry benchmarks. The results are strong, but there are 3 areas for improvement.",
                        "The cash flow projection indicates a potential shortfall in month 6. Let me suggest some mitigation strategies."
                    ]
                };
                
                // Simple keyword-based response selection
                const message = userMessage.toLowerCase();
                let responsePool = responses[assistantType];
                
                if (message.includes('risk') || message.includes('problem')) {
                    responsePool = [
                        "I've identified several risk factors that need immediate attention. The primary concern is the labor cost assumption which is 15% below historical benchmarks.",
                        "The risk analysis shows moderate exposure in three key areas: labor costs, supply chain volatility, and contract terms. Let me provide detailed mitigation strategies.",
                        "Based on the risk assessment, I recommend implementing additional safeguards in the operational plan to address the identified vulnerabilities."
                    ];
                } else if (message.includes('margin') || message.includes('profit')) {
                    responsePool = [
                        "The margin analysis reveals a 3.2% gap compared to similar contracts. Implementing the recommended changes could close this gap entirely.",
                        "I've identified three specific areas where margin improvement is possible: labor optimization (1.8%), supply chain efficiency (0.9%), and waste reduction (0.5%).",
                        "The current margin projection is solid, but there's potential for an additional 2.7% improvement through operational efficiencies."
                    ];
                } else if (message.includes('recommend') || message.includes('suggest')) {
                    responsePool = [
                        "Based on my analysis, I recommend: 1) Adjusting the labor model, 2) Implementing tiered pricing, and 3) Adding inflation adjustment clauses.",
                        "Here are my top three recommendations: Optimize staffing during peak hours, renegotiate with key suppliers, and implement predictive maintenance scheduling.",
                        "I suggest focusing on these areas: labor efficiency improvements, supply chain optimization, and enhanced customer engagement strategies."
                    ];
                }
                
                return responsePool[Math.floor(Math.random() * responsePool.length)];
            }

            // Switch assistant
            function switchAssistant(assistantId) {
                currentAssistant = assistantId;
                const assistant = assistants[assistantId];
                
                // Update UI
                assistantName.textContent = assistant.name;
                assistantStatus.textContent = 'Online - Ready to help';
                statusBadge.className = `badge bg-${assistant.color}`;
                
                // Clear chat and add welcome message
                chatContainer.innerHTML = '';
                addMessage(assistant.welcomeMessage, 'ai');
                
                // Update active assistant in the list
                document.querySelectorAll('.assistant-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-assistant="${assistantId}"]`).classList.add('active');
            }

            // Event listeners
            sendMessageBtn.addEventListener('click', sendMessage);
            
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            newChatBtn.addEventListener('click', function() {
                if (confirm('Start a new conversation? The current chat will be saved.')) {
                    switchAssistant(currentAssistant);
                }
            });
            
            clearHistoryBtn.addEventListener('click', function() {
                if (confirm('Clear all conversation history? This action cannot be undone.')) {
                    document.querySelector('.conversation-list').innerHTML = '<p class="text-muted text-center py-3">No recent conversations</p>';
                }
            });
            
            // Assistant selection
            document.querySelectorAll('.assistant-item').forEach(item => {
                item.addEventListener('click', function() {
                    const assistantId = this.getAttribute('data-assistant');
                    switchAssistant(assistantId);
                });
            });
            
            // Quick actions
            document.querySelectorAll('.quick-action-btn, .chat-quick-action').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.getAttribute('data-action');
                    let message = '';
                    
                    switch(action) {
                        case 'analyze-contract':
                        case 'analyze-bid':
                            message = "Please analyze this contract bid and identify any risks or optimization opportunities.";
                            break;
                        case 'performance-review':
                            message = "Can you provide a performance review for the last quarter?";
                            break;
                        case 'margin-simulation':
                        case 'margin-sim':
                            message = "Run a margin simulation with different labor cost scenarios.";
                            break;
                        case 'get-recommendations':
                            message = "What recommendations do you have for improving operational efficiency?";
                            break;
                        case 'generate-report':
                            message = "Generate a comprehensive risk assessment report for this contract.";
                            break;
                    }
                    
                    if (message) {
                        messageInput.value = message;
                        sendMessage();
                    }
                });
            });
            
            // Initialize chat with welcome message
            switchAssistant('bid-analysis');
        });
    </script>
</body>

</html>